<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Execução da Tarefa - JurisTrack</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/menu.css">
    <link rel="stylesheet" href="/css/tarefasExecucao.css">
</head>
<body>
    <div class="d-flex flex-column flex-lg-row layout-wrapper">
        <app-sidebar style="display: contents;"></app-sidebar>

        <div class="flex-grow-1 p-4 main-area">
            <div class="d-flex flex-column flex-xl-row justify-content-between align-items-start align-items-xl-center gap-3 mb-4">
                <div>
                    <h2 class="fw-bold text-dark mb-1" id="task-title">Workspace da Tarefa</h2>
                    <p class="text-muted mb-0" id="task-subtitle">Carregando detalhes da execução...</p>
                </div>
                <div class="d-flex flex-wrap gap-2 align-items-center">
                    <span class="badge rounded-pill bg-light text-dark border" id="task-priority">Prioridade</span>
                    <span class="badge rounded-pill text-white" id="task-status">Status</span>
                    <span class="badge rounded-pill bg-primary-subtle text-primary" id="task-due">Prazo</span>
                </div>
            </div>

            <div id="execucao-feedback" class="alert d-none mb-3" role="alert" aria-live="polite"></div>

            <div class="status-flow card shadow-sm border-0 mb-4">
                <div class="card-body">
                    <div class="d-flex flex-wrap gap-2 align-items-center" id="status-flow">
                        <span class="status-step">Aguardando</span>
                        <span class="status-step">Em Elaboração</span>
                        <span class="status-step">Em Revisão</span>
                        <span class="status-step">Pronto para Protocolo</span>
                        <span class="status-step">Protocolado</span>
                    </div>
                </div>
            </div>

            <div class="row g-4">
                <div class="col-12 col-xl-5">
                    <div class="card shadow-sm border-0 checklist-card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h5 class="fw-bold mb-0"><i class="fas fa-list-check text-primary me-2"></i>Checklist</h5>
                                <span class="badge bg-light text-dark border" id="checklist-progress">0/0</span>
                            </div>

                            <div class="checklist-scroll">
                                <div id="checklist-empty" class="text-muted small mb-3 d-none">
                                    Nenhum item no checklist.
                                </div>
                                <div class="checklist-list" id="checklist-list"></div>
                            </div>

                            <div class="mt-4">
                                <label class="form-label text-muted small fw-bold" for="checklist-input">Adicionar item</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="checklist-input" placeholder="Descreva o próximo passo">
                                    <button class="btn btn-primary" type="button" id="checklist-add">
                                        <i class="fas fa-plus me-1"></i>Adicionar
                                    </button>
                                </div>
                                <div class="form-text">Itens adicionados aqui são opcionais por padrão.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-xl-7">
                    <div class="card shadow-sm border-0 mb-4">
                        <div class="card-body">
                            <h5 class="fw-bold mb-3"><i class="fas fa-circle-info text-primary me-2"></i>Contexto</h5>
                            <div class="accordion context-accordion" id="context-accordion">
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#context-processo-panel" aria-expanded="true" aria-controls="context-processo-panel">
                                            Dados do processo
                                        </button>
                                    </h2>
                                    <div id="context-processo-panel" class="accordion-collapse collapse show" data-bs-parent="#context-accordion">
                                        <div class="accordion-body">
                                            <div class="context-row">
                                                <span class="context-label">Numero</span>
                                                <span class="context-value" id="context-processo-numero">--</span>
                                            </div>
                                            <div class="context-row">
                                                <span class="context-label">Assunto</span>
                                                <span class="context-value" id="context-processo-assunto">--</span>
                                            </div>
                                            <div class="context-row">
                                                <span class="context-label">Pasta</span>
                                                <span class="context-value" id="context-processo-pasta">--</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#context-publicacoes-panel" aria-expanded="false" aria-controls="context-publicacoes-panel">
                                            Publicacoes
                                        </button>
                                    </h2>
                                    <div id="context-publicacoes-panel" class="accordion-collapse collapse" data-bs-parent="#context-accordion">
                                        <div class="accordion-body">
                                            <div id="context-publicacoes"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#context-andamentos-panel" aria-expanded="false" aria-controls="context-andamentos-panel">
                                            Andamentos
                                        </button>
                                    </h2>
                                    <div id="context-andamentos-panel" class="accordion-collapse collapse" data-bs-parent="#context-accordion">
                                        <div class="accordion-body">
                                            <div id="context-andamentos"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#context-evento-panel" aria-expanded="false" aria-controls="context-evento-panel">
                                            Evento / Providencia
                                        </button>
                                    </h2>
                                    <div id="context-evento-panel" class="accordion-collapse collapse" data-bs-parent="#context-accordion">
                                        <div class="accordion-body">
                                            <div class="context-row">
                                                <span class="context-label">Evento</span>
                                                <span class="context-value" id="context-evento">--</span>
                                            </div>
                                            <div class="context-row context-muted" id="context-evento-descricao">--</div>
                                            <div class="context-row">
                                                <span class="context-label">Providencia</span>
                                                <span class="context-value" id="context-providencia">--</span>
                                            </div>
                                            <div class="context-row context-muted" id="context-providencia-descricao">--</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#context-documentos-panel" aria-expanded="false" aria-controls="context-documentos-panel">
                                            Documentos / Anexo
                                        </button>
                                    </h2>
                                    <div id="context-documentos-panel" class="accordion-collapse collapse" data-bs-parent="#context-accordion">
                                        <div class="accordion-body">
                                            <div id="context-documentos"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card shadow-sm border-0 mb-4">
                        <div class="card-body">
                            <h5 class="fw-bold mb-3"><i class="fas fa-flag-checkered text-primary me-2"></i>Acoes de Status</h5>
                            <div class="d-flex flex-wrap gap-2" id="status-actions"></div>
                        </div>
                    </div>

                    <div class="card shadow-sm border-0">
                        <div class="card-body">
                            <h5 class="fw-bold mb-3"><i class="fas fa-cloud-upload-alt text-primary me-2"></i>Upload do Comprovante</h5>
                            <p class="text-muted mb-3">
                                O protocolo so sera liberado apos anexar o comprovante e concluir o checklist obrigatorio.
                            </p>
                            <input class="form-control" type="file" id="protocol-file" accept=".pdf,.png,.jpg,.jpeg,.doc,.docx">
                            <div class="d-flex flex-wrap gap-2 mt-3">
                                <button class="btn btn-success" id="protocol-submit" disabled>
                                    <i class="fas fa-rocket me-2"></i>Marcar como Protocolado
                                </button>
                                <span class="small text-muted align-self-center" id="protocol-hint">Selecione um arquivo para continuar.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/tarefasExecucao.js"></script>
    <script src="/js/components/sidebar.js"></script>
</body>
</html>
